import{_ as o}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as p,c as i,a as s,b as n,d as t,e,r as l}from"./app.d7b34baa.js";const c={},r=s("h1",{id:"结构型模式-structural-patterns",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#结构型模式-structural-patterns","aria-hidden":"true"},"#"),n(" 结构型模式 Structural Patterns")],-1),u={href:"https://refactoringguru.cn/",target:"_blank",rel:"noopener noreferrer"},d=s("p",null,"附带常见模式代码实现",-1),k=e('<h2 id="adapter-适配器" tabindex="-1"><a class="header-anchor" href="#adapter-适配器" aria-hidden="true">#</a> Adapter 适配器</h2><p><strong>适配器模式</strong>是一种结构型设计模式， 它能使接口不兼容的对象能够相互合作。</p><p>The adapter pattern is a structural design pattern that enables objects with incompatible interfaces to cooperate.</p><img src="https://cdn.yihuiblog.top/images/202212021734263.png" alt="适配器设计模式的结构（对象适配器）" style="zoom:67%;"><ol><li><strong>客户端</strong> （Client） 是包含当前程序业务逻辑的类。</li><li><strong>客户端接口</strong> （Client Interface） 描述了其他类与客户端代码合作时必须遵循的协议。</li><li><strong>服务</strong> （Service） 中有一些功能类 （通常来自第三方或遗留系统）。 客户端与其接口不兼容， 因此无法直接调用其功能。</li><li><strong>适配器</strong> （Adapter） 是一个可以同时与客户端和服务交互的类： 它在实现客户端接口的同时封装了服务对象。 适配器接受客户端通过适配器接口发起的调用， 并将其转换为适用于被封装服务对象的调用。</li><li>客户端代码只需通过接口与适配器交互即可， 无需与具体的适配器类耦合。 因此， 你可以向程序中添加新类型的适配器而无需修改已有代码。 这在服务类的接口被更改或替换时很有用： 你无需修改客户端代码就可以创建新的适配器类。</li></ol><img src="https://cdn.yihuiblog.top/images/202212021734642.png" alt="适配器设计模式（类适配器）" style="zoom:67%;"><h3 id="场景" tabindex="-1"><a class="header-anchor" href="#场景" aria-hidden="true">#</a> 场景</h3><ul><li>当你希望使用某个类， 但是其接口与其他代码不兼容时， 可以使用适配器类。</li><li>如果您需要复用这样一些类， 他们处于同一个继承体系， 并且他们又有了额外的一些共同的方法， 但是这些共同的方法不是所有在这一继承体系中的子类所具有的共性。</li></ul><h3 id="优缺点" tabindex="-1"><a class="header-anchor" href="#优缺点" aria-hidden="true">#</a> 优缺点</h3><p><strong>Advantages:</strong></p><ul><li>_单一职责原则_你可以将接口或数据转换代码从程序主要业务逻辑中分离。</li><li><em>开闭原则</em>。 只要客户端代码通过客户端接口与适配器进行交互， 你就能在不修改现有客户端代码的情况下在程序中添加新类型的适配器。</li></ul><p><strong>Disadvantages:</strong></p><ul><li>代码整体复杂度增加， 因为你需要新增一系列接口和类。 有时直接更改服务类使其与其他代码兼容会更简单。</li></ul><h3 id="关系" tabindex="-1"><a class="header-anchor" href="#关系" aria-hidden="true">#</a> 关系</h3>',14),v={href:"https://refactoringguru.cn/design-patterns/bridge",target:"_blank",rel:"noopener noreferrer"},m={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},b={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},h={href:"https://refactoringguru.cn/design-patterns/decorator",target:"_blank",rel:"noopener noreferrer"},g=s("em",null,"装饰",-1),f=s("em",null,"适配器",-1),_={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},y={href:"https://refactoringguru.cn/design-patterns/proxy",target:"_blank",rel:"noopener noreferrer"},q={href:"https://refactoringguru.cn/design-patterns/decorator",target:"_blank",rel:"noopener noreferrer"},w={href:"https://refactoringguru.cn/design-patterns/facade",target:"_blank",rel:"noopener noreferrer"},C={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},x=s("em",null,"适配器",-1),T=s("em",null,"外观",-1),A={href:"https://refactoringguru.cn/design-patterns/bridge",target:"_blank",rel:"noopener noreferrer"},S={href:"https://refactoringguru.cn/design-patterns/state",target:"_blank",rel:"noopener noreferrer"},j={href:"https://refactoringguru.cn/design-patterns/strategy",target:"_blank",rel:"noopener noreferrer"},F={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},I={href:"https://refactoringguru.cn/design-patterns/composite",target:"_blank",rel:"noopener noreferrer"},D=e(`<h3 id="code" tabindex="-1"><a class="header-anchor" href="#code" aria-hidden="true">#</a> Code</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Target</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The Target defines the domain-specific interface used by the client code.
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">request</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Target: The default target&#39;s behavior.&quot;</span>


<span class="token keyword">class</span> <span class="token class-name">Adaptee</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The Adaptee contains some useful behavior, but its interface is incompatible
    with the existing client code. The Adaptee needs some adaptation before the
    client code can use it.
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">specific_request</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;.eetpadA eht fo roivaheb laicepS&quot;</span>


<span class="token keyword">class</span> <span class="token class-name">Adapter</span><span class="token punctuation">(</span>Target<span class="token punctuation">,</span> Adaptee<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The Adapter makes the Adaptee&#39;s interface compatible with the Target&#39;s
    interface via multiple inheritance.
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">request</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;Adapter: (TRANSLATED) </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>specific_request<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token format-spec">-1]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>


<span class="token keyword">def</span> <span class="token function">client_code</span><span class="token punctuation">(</span>target<span class="token punctuation">:</span> <span class="token string">&quot;Target&quot;</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The client code supports all classes that follow the Target interface.
    &quot;&quot;&quot;</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Client: I can work just fine with the Target objects:&quot;</span><span class="token punctuation">)</span>
    target <span class="token operator">=</span> Target<span class="token punctuation">(</span><span class="token punctuation">)</span>
    client_code<span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span>

    adaptee <span class="token operator">=</span> Adaptee<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Client: The Adaptee class has a weird interface. &quot;</span>
          <span class="token string">&quot;See, I don&#39;t understand it:&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Adaptee: </span><span class="token interpolation"><span class="token punctuation">{</span>adaptee<span class="token punctuation">.</span>specific_request<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;\\n\\n&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Client: But I can work with it via the Adapter:&quot;</span><span class="token punctuation">)</span>
    adapter <span class="token operator">=</span> Adapter<span class="token punctuation">(</span><span class="token punctuation">)</span>
    client_code<span class="token punctuation">(</span>adapter<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="bridge-桥接" tabindex="-1"><a class="header-anchor" href="#bridge-桥接" aria-hidden="true">#</a> Bridge 桥接</h2><p><strong>桥接模式</strong>是一种结构型设计模式， 可将一个大类或一系列紧密相关的类拆分为抽象和实现两个独立的层次结构， 从而能在开发时分别使用。</p><p>The bridging pattern is a structural design pattern that splits a large class or series of closely related classes into two separate hierarchies of abstraction and implementation that can be used separately at development time.</p><img src="https://cdn.yihuiblog.top/images/202212021735089.png" alt="桥接设计模式" style="zoom:67%;"><ol><li><p><strong>抽象部分</strong> （Abstraction） 提供高层控制逻辑， 依赖于完成底层实际工作的实现对象。</p></li><li><p><strong>实现部分</strong> （Implementation） 为所有具体实现声明通用接口。 抽象部分仅能通过在这里声明的方法与实现对象交互。</p><p>抽象部分可以列出和实现部分一样的方法， 但是抽象部分通常声明一些复杂行为， 这些行为依赖于多种由实现部分声明的原语操作。</p></li><li><p><strong>具体实现</strong> （Concrete Implementations） 中包括特定于平台的代码。</p></li><li><p><strong>精确抽象</strong> （Refined Abstraction） 提供控制逻辑的变体。 与其父类一样， 它们通过通用实现接口与不同的实现进行交互。</p></li><li><p>通常情况下， <strong>客户端</strong> （Client） 仅关心如何与抽象部分合作。 但是， 客户端需要将抽象对象与一个实现对象连接起来。</p></li></ol><img src="https://cdn.yihuiblog.top/images/202212021735562.png" alt="桥接模式示例的结构" style="zoom:67%;"><h3 id="场景-1" tabindex="-1"><a class="header-anchor" href="#场景-1" aria-hidden="true">#</a> 场景</h3><ul><li>如果你想要拆分或重组一个具有多重功能的庞杂类 （例如能与多个数据库服务器进行交互的类）， 可以使用桥接模式。</li><li>如果你希望在几个独立维度上扩展一个类， 可使用该模式。</li><li>如果你需要在运行时切换不同实现方法， 可使用桥接模式。</li></ul><h3 id="优缺点-1" tabindex="-1"><a class="header-anchor" href="#优缺点-1" aria-hidden="true">#</a> 优缺点</h3><ul><li>你可以创建与平台无关的类和程序。</li><li>客户端代码仅与高层抽象部分进行互动， 不会接触到平台的详细信息。</li><li><em>开闭原则</em>。 你可以新增抽象部分和实现部分， 且它们之间不会相互影响。</li><li><em>单一职责原则</em>。 抽象部分专注于处理高层逻辑， 实现部分处理平台细节。</li></ul><p><strong>Disadvantages:</strong></p><p>对高内聚的类使用该模式可能会让代码更加复杂。</p><h3 id="关系-1" tabindex="-1"><a class="header-anchor" href="#关系-1" aria-hidden="true">#</a> 关系</h3><p><strong>What is the difference between the bridge and adapter patterns?</strong></p>`,16),N={href:"https://refactoringguru.cn/design-patterns/bridge",target:"_blank",rel:"noopener noreferrer"},P={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},L=e(`<h3 id="code-1" tabindex="-1"><a class="header-anchor" href="#code-1" aria-hidden="true">#</a> Code⭐</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> annotations
<span class="token keyword">from</span> abc <span class="token keyword">import</span> ABC<span class="token punctuation">,</span> abstractmethod


<span class="token keyword">class</span> <span class="token class-name">Phone</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> implementation<span class="token punctuation">:</span> Implementation<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>implementation <span class="token operator">=</span> implementation

    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Abstraction Phone: Base operation with:\\n&quot;</span></span>
                <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">OPPO</span><span class="token punctuation">(</span>Phone<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;OPPO: Extended operation with OPPO:\\n&quot;</span></span>
                <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">ViVo</span><span class="token punctuation">(</span>Phone<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;ViVo: Extended operation with ViVo:\\n&quot;</span></span>
                <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Implementation</span><span class="token punctuation">(</span>ABC<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>


<span class="token keyword">class</span> <span class="token class-name">SoftWare</span><span class="token punctuation">(</span>Implementation<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;SoftWare: Here&#39;s the result&quot;</span>


<span class="token keyword">class</span> <span class="token class-name">Appstore</span><span class="token punctuation">(</span>Implementation<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Appstore: Here&#39;s the result&quot;</span>


<span class="token keyword">class</span> <span class="token class-name">Camera</span><span class="token punctuation">(</span>Implementation<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Camera: Here&#39;s the result&quot;</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    implementation <span class="token operator">=</span> SoftWare<span class="token punctuation">(</span><span class="token punctuation">)</span>
    abstraction <span class="token operator">=</span> Phone<span class="token punctuation">(</span>implementation<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>abstraction<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    implementation <span class="token operator">=</span> Camera<span class="token punctuation">(</span><span class="token punctuation">)</span>
    abstraction <span class="token operator">=</span> ViVo<span class="token punctuation">(</span>implementation<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>abstraction<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    abstraction <span class="token operator">=</span> OPPO<span class="token punctuation">(</span>implementation<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>abstraction<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="decorator-装饰器" tabindex="-1"><a class="header-anchor" href="#decorator-装饰器" aria-hidden="true">#</a> Decorator 装饰器</h2><p><strong>装饰模式</strong>是一种结构型设计模式， 允许你通过将对象放入包含行为的特殊封装对象中来为原对象绑定新的行为。</p><p>Decorator is a structural design pattern that allows you to bind new behavior to an object by putting it into a special wrapper that contains behavior.</p><img src="https://cdn.yihuiblog.top/images/202212021735422.png" alt="装饰设计模式的结构" style="zoom:67%;"><ol><li><strong>部件</strong> （Component） 声明封装器和被封装对象的公用接口。</li><li><strong>具体部件</strong> （Concrete Component） 类是被封装对象所属的类。 它定义了基础行为， 但装饰类可以改变这些行为。</li><li><strong>基础装饰</strong> （Base Decorator） 类拥有一个指向被封装对象的引用成员变量。 该变量的类型应当被声明为通用部件接口， 这样它就可以引用具体的部件和装饰。 装饰基类会将所有操作委派给被封装的对象。</li><li><strong>具体装饰类</strong> （Concrete Decorators） 定义了可动态添加到部件的额外行为。 具体装饰类会重写装饰基类的方法， 并在调用父类方法之前或之后进行额外的行为。</li><li><strong>客户端</strong> （Client） 可以使用多层装饰来封装部件， 只要它能使用通用接口与所有对象互动即可。</li></ol><h3 id="场景-2" tabindex="-1"><a class="header-anchor" href="#场景-2" aria-hidden="true">#</a> 场景</h3><ul><li>如果你希望在无需修改代码的情况下即可使用对象， 且希望在运行时为对象新增额外的行为， 可以使用装饰模式。</li><li>如果用继承来扩展对象行为的方案难以实现或者根本不可行， 你可以使用该模式。</li></ul><h3 id="优缺点-2" tabindex="-1"><a class="header-anchor" href="#优缺点-2" aria-hidden="true">#</a> 优缺点</h3><p><strong>Advantages:</strong></p><ul><li>你无需创建新子类即可扩展对象的行为。</li><li>你可以在运行时添加或删除对象的功能。</li><li>你可以用多个装饰封装对象来组合几种行为。</li><li><em>单一职责原则</em>。 你可以将实现了许多不同行为的一个大类拆分为多个较小的类。</li></ul><p><strong>Disadvantages:</strong></p><ul><li>在封装器栈中删除特定封装器比较困难。</li><li>实现行为不受装饰栈顺序影响的装饰比较困难。</li><li>各层的初始化配置代码看上去可能会很糟糕。</li></ul><h3 id="关系-2" tabindex="-1"><a class="header-anchor" href="#关系-2" aria-hidden="true">#</a> 关系</h3>`,15),V={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},B={href:"https://refactoringguru.cn/design-patterns/decorator",target:"_blank",rel:"noopener noreferrer"},z=s("em",null,"装饰",-1),E=s("em",null,"适配器",-1),O={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},R={href:"https://refactoringguru.cn/design-patterns/proxy",target:"_blank",rel:"noopener noreferrer"},U={href:"https://refactoringguru.cn/design-patterns/decorator",target:"_blank",rel:"noopener noreferrer"},W={href:"https://refactoringguru.cn/design-patterns/decorator",target:"_blank",rel:"noopener noreferrer"},H={href:"https://refactoringguru.cn/design-patterns/proxy",target:"_blank",rel:"noopener noreferrer"},G=s("em",null,"代理",-1),Y=s("em",null,"装饰",-1),J=e(`<h3 id="code-2" tabindex="-1"><a class="header-anchor" href="#code-2" aria-hidden="true">#</a> Code⭐</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Component</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>


<span class="token keyword">class</span> <span class="token class-name">ConcreteComponent</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ConcreteComponent&quot;</span>


<span class="token keyword">class</span> <span class="token class-name">Decorator</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span><span class="token punctuation">:</span>
    _component<span class="token punctuation">:</span> Component <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> component<span class="token punctuation">:</span> Component<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_component <span class="token operator">=</span> component

    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">component</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_component

    <span class="token keyword">def</span> <span class="token function">operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_component<span class="token punctuation">.</span>operation<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">ConcreteDecoratorA</span><span class="token punctuation">(</span>Decorator<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;ConcreteDecoratorA(</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>component<span class="token punctuation">.</span>operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span>


<span class="token keyword">class</span> <span class="token class-name">ConcreteDecoratorB</span><span class="token punctuation">(</span>Decorator<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;ConcreteDecoratorB(</span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>component<span class="token punctuation">.</span>operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span>


<span class="token keyword">def</span> <span class="token function">client_code</span><span class="token punctuation">(</span>component<span class="token punctuation">:</span> Component<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>

    <span class="token comment"># ...</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;RESULT: </span><span class="token interpolation"><span class="token punctuation">{</span>component<span class="token punctuation">.</span>operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># ...</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    simple <span class="token operator">=</span> ConcreteComponent<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Client: I&#39;ve got a simple component:&quot;</span><span class="token punctuation">)</span>
    client_code<span class="token punctuation">(</span>simple<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span>

    decorator1 <span class="token operator">=</span> ConcreteDecoratorA<span class="token punctuation">(</span>simple<span class="token punctuation">)</span>
    decorator2 <span class="token operator">=</span> ConcreteDecoratorB<span class="token punctuation">(</span>decorator1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Client: Now I&#39;ve got a decorated component:&quot;</span><span class="token punctuation">)</span>
    client_code<span class="token punctuation">(</span>decorator2<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="facade-外观" tabindex="-1"><a class="header-anchor" href="#facade-外观" aria-hidden="true">#</a> Facade 外观</h2><p><strong>外观模式</strong>是一种结构型设计模式， 能为程序库、 框架或其他复杂类提供一个简单的接口。</p><p>The facade pattern is a structural design pattern that provides a simple interface to libraries, frameworks, or other complex classes.</p><img src="https://cdn.yihuiblog.top/images/202212021735646.png" alt="外观设计模式的结构" style="zoom:67%;"><ol><li><p><strong>外观</strong> （Facade） 提供了一种访问特定子系统功能的便捷方式， 其了解如何重定向客户端请求， 知晓如何操作一切活动部件。</p></li><li><p>创建<strong>附加外观</strong> （Additional Facade） 类可以避免多种不相关的功能污染单一外观， 使其变成又一个复杂结构。 客户端和其他外观都可使用附加外观。</p></li><li><p><strong>复杂子系统</strong> （Complex Subsystem） 由数十个不同对象构成。 如果要用这些对象完成有意义的工作， 你必须深入了解子系统的实现细节， 比如按照正确顺序初始化对象和为其提供正确格式的数据。</p><p>子系统类不会意识到外观的存在， 它们在系统内运作并且相互之间可直接进行交互。</p></li><li><p><strong>客户端</strong> （Client） 使用外观代替对子系统对象的直接调用。</p></li></ol><h3 id="场景-3" tabindex="-1"><a class="header-anchor" href="#场景-3" aria-hidden="true">#</a> 场景</h3><ul><li>如果你需要一个指向复杂子系统的直接接口， 且该接口的功能有限， 则可以使用外观模式。</li><li>如果需要将子系统组织为多层结构， 可以使用外观。</li></ul><h3 id="优缺点-3" tabindex="-1"><a class="header-anchor" href="#优缺点-3" aria-hidden="true">#</a> 优缺点</h3><p><strong>Advantages:</strong></p><ul><li>你可以让自己的代码独立于复杂子系统。</li></ul><p><strong>Disadvantages:</strong></p>`,13),K={href:"https://refactoringguru.cn/antipatterns/god-object",target:"_blank",rel:"noopener noreferrer"},M=s("h3",{id:"关系-3",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#关系-3","aria-hidden":"true"},"#"),n(" 关系")],-1),Q={href:"https://refactoringguru.cn/design-patterns/facade",target:"_blank",rel:"noopener noreferrer"},X={href:"https://refactoringguru.cn/design-patterns/proxy",target:"_blank",rel:"noopener noreferrer"},Z=s("em",null,"代理",-1),$=s("em",null,"外观",-1),nn={href:"https://refactoringguru.cn/design-patterns/facade",target:"_blank",rel:"noopener noreferrer"},sn={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},an=s("em",null,"适配器",-1),tn=s("em",null,"外观",-1),en={href:"https://refactoringguru.cn/design-patterns/abstract-factory",target:"_blank",rel:"noopener noreferrer"},on={href:"https://refactoringguru.cn/design-patterns/facade",target:"_blank",rel:"noopener noreferrer"},pn=e(`<h3 id="code-3" tabindex="-1"><a class="header-anchor" href="#code-3" aria-hidden="true">#</a> Code</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Facade</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The Facade class provides a simple interface to the complex logic of one or
    several subsystems. The Facade delegates the client requests to the
    appropriate objects within the subsystem. The Facade is also responsible for
    managing their lifecycle. All of this shields the client from the undesired
    complexity of the subsystem.
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> subsystem1<span class="token punctuation">:</span> Subsystem1<span class="token punctuation">,</span> subsystem2<span class="token punctuation">:</span> Subsystem2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        Depending on your application&#39;s needs, you can provide the Facade with
        existing subsystem objects or force the Facade to create them on its
        own.
        &quot;&quot;&quot;</span>

        self<span class="token punctuation">.</span>_subsystem1 <span class="token operator">=</span> subsystem1 <span class="token keyword">or</span> Subsystem1<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>_subsystem2 <span class="token operator">=</span> subsystem2 <span class="token keyword">or</span> Subsystem2<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        The Facade&#39;s methods are convenient shortcuts to the sophisticated
        functionality of the subsystems. However, clients get only to a fraction
        of a subsystem&#39;s capabilities.
        &quot;&quot;&quot;</span>

        results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">&quot;Facade initializes subsystems:&quot;</span><span class="token punctuation">)</span>
        results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_subsystem1<span class="token punctuation">.</span>operation1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_subsystem2<span class="token punctuation">.</span>operation1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">&quot;Facade orders subsystems to perform the action:&quot;</span><span class="token punctuation">)</span>
        results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_subsystem1<span class="token punctuation">.</span>operation_n<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>_subsystem2<span class="token punctuation">.</span>operation_z<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">&quot;\\n&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>results<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Subsystem1</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The Subsystem can accept requests either from the facade or client directly.
    In any case, to the Subsystem, the Facade is yet another client, and it&#39;s
    not a part of the Subsystem.
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">operation1</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Subsystem1: Ready!&quot;</span>

    <span class="token comment"># ...</span>

    <span class="token keyword">def</span> <span class="token function">operation_n</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Subsystem1: Go!&quot;</span>


<span class="token keyword">class</span> <span class="token class-name">Subsystem2</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    Some facades can work with multiple subsystems at the same time.
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">operation1</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Subsystem2: Get ready!&quot;</span>

    <span class="token comment"># ...</span>

    <span class="token keyword">def</span> <span class="token function">operation_z</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Subsystem2: Fire!&quot;</span>


<span class="token keyword">def</span> <span class="token function">client_code</span><span class="token punctuation">(</span>facade<span class="token punctuation">:</span> Facade<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The client code works with complex subsystems through a simple interface
    provided by the Facade. When a facade manages the lifecycle of the
    subsystem, the client might not even know about the existence of the
    subsystem. This approach lets you keep the complexity under control.
    &quot;&quot;&quot;</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>facade<span class="token punctuation">.</span>operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># The client code may have some of the subsystem&#39;s objects already created.</span>
    <span class="token comment"># In this case, it might be worthwhile to initialize the Facade with these</span>
    <span class="token comment"># objects instead of letting the Facade create new instances.</span>
    subsystem1 <span class="token operator">=</span> Subsystem1<span class="token punctuation">(</span><span class="token punctuation">)</span>
    subsystem2 <span class="token operator">=</span> Subsystem2<span class="token punctuation">(</span><span class="token punctuation">)</span>
    facade <span class="token operator">=</span> Facade<span class="token punctuation">(</span>subsystem1<span class="token punctuation">,</span> subsystem2<span class="token punctuation">)</span>
    client_code<span class="token punctuation">(</span>facade<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="proxy-代理模式" tabindex="-1"><a class="header-anchor" href="#proxy-代理模式" aria-hidden="true">#</a> Proxy 代理模式</h2><p><strong>代理模式</strong>是一种结构型设计模式， 让你能够提供对象的替代品或其占位符。 代理控制着对于原对象的访问， 并允许在将请求提交给对象前后进行一些处理。</p><p>Proxy pattern is a structural design pattern that allows you to provide substitutes for objects or placeholders for them. The proxy controls access to the original object and allows some processing before and after the request is submitted to the object.</p><img src="https://cdn.yihuiblog.top/images/202212021735199.png" alt="代理设计模式的结构" style="zoom:67%;"><ol><li><strong>服务接口</strong> （Service Interface） 声明了服务接口。 代理必须遵循该接口才能伪装成服务对象。</li><li><strong>服务</strong> （Service） 类提供了一些实用的业务逻辑。</li><li><strong>代理</strong> （Proxy） 类包含一个指向服务对象的引用成员变量。 代理完成其任务 （例如延迟初始化、 记录日志、 访问控制和缓存等） 后会将请求传递给服务对象。 通常情况下， 代理会对其服务对象的整个生命周期进行管理。</li><li><strong>客户端</strong> （Client） 能通过同一接口与服务或代理进行交互， 所以你可在一切需要服务对象的代码中使用代理。</li></ol><h3 id="场景-4" tabindex="-1"><a class="header-anchor" href="#场景-4" aria-hidden="true">#</a> 场景</h3><ul><li>延迟初始化 （虚拟代理）。 如果你有一个偶尔使用的重量级服务对象， 一直保持该对象运行会消耗系统资源时， 可使用代理模式。</li><li>访问控制 （保护代理）。 如果你只希望特定客户端使用服务对象， 这里的对象可以是操作系统中非常重要的部分， 而客户端则是各种已启动的程序 （包括恶意程序）， 此时可使用代理模式。</li><li>本地执行远程服务 （远程代理）。 适用于服务对象位于远程服务器上的情形。</li><li>记录日志请求 （日志记录代理）。 适用于当你需要保存对于服务对象的请求历史记录时。 代理可以在向服务传递请求前进行记录。</li></ul><h3 id="优缺点-4" tabindex="-1"><a class="header-anchor" href="#优缺点-4" aria-hidden="true">#</a> 优缺点</h3><p><strong>Advantages:</strong></p><ul><li>你可以在客户端毫无察觉的情况下控制服务对象。</li><li>如果客户端对服务对象的生命周期没有特殊要求， 你可以对生命周期进行管理。</li><li>即使服务对象还未准备好或不存在， 代理也可以正常工作。</li><li><em>开闭原则</em>。 你可以在不对服务或客户端做出修改的情况下创建新代理。</li></ul><p><strong>Disadvantages:</strong></p><ul><li>代码可能会变得复杂， 因为需要新建许多类。</li><li>服务响应可能会延迟。</li></ul><h3 id="关系-4" tabindex="-1"><a class="header-anchor" href="#关系-4" aria-hidden="true">#</a> 关系</h3>`,15),ln={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},cn={href:"https://refactoringguru.cn/design-patterns/proxy",target:"_blank",rel:"noopener noreferrer"},rn={href:"https://refactoringguru.cn/design-patterns/decorator",target:"_blank",rel:"noopener noreferrer"},un={href:"https://refactoringguru.cn/design-patterns/facade",target:"_blank",rel:"noopener noreferrer"},dn={href:"https://refactoringguru.cn/design-patterns/proxy",target:"_blank",rel:"noopener noreferrer"},kn=s("em",null,"代理",-1),vn=s("em",null,"外观",-1),mn={href:"https://refactoringguru.cn/design-patterns/decorator",target:"_blank",rel:"noopener noreferrer"},bn={href:"https://refactoringguru.cn/design-patterns/proxy",target:"_blank",rel:"noopener noreferrer"},hn=s("strong",null,"代理通常自行管理其服务对象的生命周期， 而装饰的生成则总是由客户端进行控制。",-1),gn=e('<h2 id="flyweight-享元" tabindex="-1"><a class="header-anchor" href="#flyweight-享元" aria-hidden="true">#</a> Flyweight 享元</h2><p><strong>享元模式</strong>是一种结构型设计模式， 它摒弃了在每个对象中保存所有数据的方式， 通过共享多个对象所共有的相同状态， 让你能在有限的内存容量中载入更多对象。</p><p>Flyweight is a structural design pattern that eliminates the need to store all data in each object and allows you to load more objects into limited memory by sharing the same state shared by multiple objects.</p><img src="https://cdn.yihuiblog.top/images/202212021735675.png" alt="享元设计模式的结构" style="zoom:67%;"><ol><li>享元模式只是一种优化。 在应用该模式之前， 你要确定程序中存在与大量类似对象同时占用内存相关的内存消耗问题， 并且确保该问题无法使用其他更好的方式来解决。</li><li><strong>享元</strong> （Flyweight） 类包含原始对象中部分能在多个对象中共享的状态。 同一享元对象可在许多不同情景中使用。 享元中存储的状态被称为 “内在状态”。 传递给享元方法的状态被称为 “外在状态”。</li><li><strong>情景</strong> （Context） 类包含原始对象中各不相同的外在状态。 情景与享元对象组合在一起就能表示原始对象的全部状态。</li><li>通常情况下， 原始对象的行为会保留在享元类中。 因此调用享元方法必须提供部分外在状态作为参数。 但你也可将行为移动到情景类中， 然后将连入的享元作为单纯的数据对象。</li><li><strong>客户端</strong> （Client） 负责计算或存储享元的外在状态。 在客户端看来， 享元是一种可在运行时进行配置的模板对象， 具体的配置方式为向其方法中传入一些情景数据参数。</li><li><strong>享元工厂</strong> （Flyweight Factory） 会对已有享元的缓存池进行管理。 有了工厂后， 客户端就无需直接创建享元， 它们只需调用工厂并向其传递目标享元的一些内在状态即可。 工厂会根据参数在之前已创建的享元中进行查找， 如果找到满足条件的享元就将其返回； 如果没有找到就根据参数新建享元。</li></ol><h3 id="场景-5" tabindex="-1"><a class="header-anchor" href="#场景-5" aria-hidden="true">#</a> 场景</h3><ul><li>仅在程序必须支持大量对象且没有足够的内存容量时使用享元模式。</li></ul><h3 id="优缺点-5" tabindex="-1"><a class="header-anchor" href="#优缺点-5" aria-hidden="true">#</a> 优缺点</h3><p><strong>Advantages:</strong></p><ul><li>如果程序中有很多相似对象， 那么你将可以节省大量内存。</li></ul><p><strong>Disadvantages:</strong></p><ul><li>你可能需要牺牲执行速度来换取内存， 因为他人每次调用享元方法时都需要重新计算部分情景数据。</li><li>代码会变得更加复杂。</li></ul><h3 id="关系-5" tabindex="-1"><a class="header-anchor" href="#关系-5" aria-hidden="true">#</a> 关系</h3>',13),fn={href:"https://refactoringguru.cn/design-patterns/flyweight",target:"_blank",rel:"noopener noreferrer"},_n={href:"https://refactoringguru.cn/design-patterns/composite",target:"_blank",rel:"noopener noreferrer"},yn={href:"https://refactoringguru.cn/design-patterns/flyweight",target:"_blank",rel:"noopener noreferrer"},qn={href:"https://refactoringguru.cn/design-patterns/facade",target:"_blank",rel:"noopener noreferrer"},wn=e(`<h3 id="code-4" tabindex="-1"><a class="header-anchor" href="#code-4" aria-hidden="true">#</a> Code⭐</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Vehicle</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> engine<span class="token punctuation">,</span> color<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>engine <span class="token operator">=</span> engine
        self<span class="token punctuation">.</span>color <span class="token operator">=</span> color

    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&#39;It start running&#39;</span>

    <span class="token keyword">def</span> <span class="token function">stop</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;It didn&#39;t running&quot;</span>

    <span class="token keyword">def</span> <span class="token function">get_color</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>color


<span class="token keyword">class</span> <span class="token class-name">Car</span><span class="token punctuation">(</span>Vehicle<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&#39;Car start running&#39;</span>

    <span class="token keyword">def</span> <span class="token function">stop</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Car didn&#39;t running&quot;</span>

    <span class="token keyword">def</span> <span class="token function">get_color</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;Car&#39;s color is </span><span class="token interpolation"><span class="token punctuation">{</span>self<span class="token punctuation">.</span>color<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span>


<span class="token keyword">class</span> <span class="token class-name">VehicleFactory</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>hashtable <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">get_cars</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Car<span class="token punctuation">:</span>
        <span class="token comment"># Avoid creating cars of the same color repeatedly</span>
        <span class="token keyword">if</span> key <span class="token keyword">not</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>hashtable<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>hashtable<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> Car<span class="token punctuation">(</span><span class="token string">&#39;default Engine&#39;</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>hashtable<span class="token punctuation">[</span>key<span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">get_car_number</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>hashtable<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span>
    factory <span class="token operator">=</span> VehicleFactory<span class="token punctuation">(</span><span class="token punctuation">)</span>
    car1 <span class="token operator">=</span> factory<span class="token punctuation">.</span>get_cars<span class="token punctuation">(</span><span class="token string">&#39;red&#39;</span><span class="token punctuation">)</span>
    car2 <span class="token operator">=</span> factory<span class="token punctuation">.</span>get_cars<span class="token punctuation">(</span><span class="token string">&#39;green&#39;</span><span class="token punctuation">)</span>
    car3 <span class="token operator">=</span> factory<span class="token punctuation">.</span>get_cars<span class="token punctuation">(</span><span class="token string">&#39;green&#39;</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>car1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>car1<span class="token punctuation">.</span>get_color<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>car1<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>car2<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>car2<span class="token punctuation">.</span>get_color<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>car2<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>factory<span class="token punctuation">.</span>get_car_number<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2 car</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="composite-组合模式" tabindex="-1"><a class="header-anchor" href="#composite-组合模式" aria-hidden="true">#</a> Composite 组合模式</h2><p><strong>组合模式</strong>是一种结构型设计模式， 你可以使用它将对象组合成树状结构， 并且能像使用独立对象一样使用它们。</p><p>The composite pattern is a structural design pattern that allows you to combine objects into a tree structure and use them as if they were individual objects.</p><img src="https://cdn.yihuiblog.top/images/202212021735184.png" alt="组合设计模式的结构" style="zoom:67%;"><ol><li><p><strong>组件</strong> （Component） 接口描述了树中简单项目和复杂项目所共有的操作。</p></li><li><p><strong>叶节点</strong> （Leaf） 是树的基本结构， 它不包含子项目。</p><p>一般情况下， 叶节点最终会完成大部分的实际工作， 因为它们无法将工作指派给其他部分。</p></li><li><p><strong>容器</strong> （Container）——又名 “组合 （Composite）”——是包含叶节点或其他容器等子项目的单位。 容器不知道其子项目所属的具体类， 它只通过通用的组件接口与其子项目交互。</p><p>容器接收到请求后会将工作分配给自己的子项目， 处理中间结果， 然后将最终结果返回给客户端。</p></li><li><p><strong>客户端</strong> （Client） 通过组件接口与所有项目交互。 因此， 客户端能以相同方式与树状结构中的简单或复杂项目交互。</p></li></ol><h3 id="场景-6" tabindex="-1"><a class="header-anchor" href="#场景-6" aria-hidden="true">#</a> 场景</h3><ul><li>如果你需要实现树状对象结构， 可以使用组合模式。</li><li>组合模式中定义的所有元素共用同一个接口。 在这一接口的帮助下， 客户端不必在意其所使用的对象的具体类。</li></ul><h3 id="优缺点-6" tabindex="-1"><a class="header-anchor" href="#优缺点-6" aria-hidden="true">#</a> 优缺点</h3><p><strong>Advantages:</strong></p><ul><li>你可以利用多态和递归机制更方便地使用复杂树结构。</li><li><em>开闭原则</em>。 无需更改现有代码， 你就可以在应用中添加新元素， 使其成为对象树的一部分。</li></ul><p><strong>Disadvantages:</strong></p><ul><li>对于功能差异较大的类， 提供公共接口或许会有困难。 在特定情况下， 你需要过度一般化组件接口， 使其变得令人难以理解。</li></ul><h3 id="关系-6" tabindex="-1"><a class="header-anchor" href="#关系-6" aria-hidden="true">#</a> 关系</h3>`,15),Cn={href:"https://refactoringguru.cn/design-patterns/bridge",target:"_blank",rel:"noopener noreferrer"},xn={href:"https://refactoringguru.cn/design-patterns/state",target:"_blank",rel:"noopener noreferrer"},Tn={href:"https://refactoringguru.cn/design-patterns/strategy",target:"_blank",rel:"noopener noreferrer"},An={href:"https://refactoringguru.cn/design-patterns/adapter",target:"_blank",rel:"noopener noreferrer"},Sn={href:"https://refactoringguru.cn/design-patterns/composite",target:"_blank",rel:"noopener noreferrer"},jn={href:"https://refactoringguru.cn/design-patterns/composite",target:"_blank",rel:"noopener noreferrer"},Fn={href:"https://refactoringguru.cn/design-patterns/builder",target:"_blank",rel:"noopener noreferrer"},In={href:"https://refactoringguru.cn/design-patterns/chain-of-responsibility",target:"_blank",rel:"noopener noreferrer"},Dn={href:"https://refactoringguru.cn/design-patterns/composite",target:"_blank",rel:"noopener noreferrer"},Nn=e(`<h3 id="code-5" tabindex="-1"><a class="header-anchor" href="#code-5" aria-hidden="true">#</a> Code</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">from</span> abc <span class="token keyword">import</span> ABC<span class="token punctuation">,</span> abstractmethod
<span class="token keyword">from</span> typing <span class="token keyword">import</span> List


<span class="token keyword">class</span> <span class="token class-name">Component</span><span class="token punctuation">(</span>ABC<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">parent</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Component<span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_parent

    <span class="token decorator annotation punctuation">@parent<span class="token punctuation">.</span>setter</span>
    <span class="token keyword">def</span> <span class="token function">parent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parent<span class="token punctuation">:</span> Component<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        Optionally, the base Component can declare an interface for setting and
        accessing a parent of the component in a tree structure. It can also
        provide some default implementation for these methods.
        &quot;&quot;&quot;</span>

        self<span class="token punctuation">.</span>_parent <span class="token operator">=</span> parent

    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    In some cases, it would be beneficial to define the child-management
    operations right in the base Component class. This way, you won&#39;t need to
    expose any concrete component classes to the client code, even during the
    object tree assembly. The downside is that these methods will be empty for
    the leaf-level components.
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> component<span class="token punctuation">:</span> Component<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">remove</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> component<span class="token punctuation">:</span> Component<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">is_composite</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        You can provide a method that lets the client code figure out whether a
        component can bear children.
        &quot;&quot;&quot;</span>

        <span class="token keyword">return</span> <span class="token boolean">False</span>

    <span class="token decorator annotation punctuation">@abstractmethod</span>
    <span class="token keyword">def</span> <span class="token function">operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        The base Component may implement some default behavior or leave it to
        concrete classes (by declaring the method containing the behavior as
        &quot;abstract&quot;).
        &quot;&quot;&quot;</span>

        <span class="token keyword">pass</span>


<span class="token keyword">class</span> <span class="token class-name">Leaf</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The Leaf class represents the end objects of a composition. A leaf can&#39;t
    have any children.

    Usually, it&#39;s the Leaf objects that do the actual work, whereas Composite
    objects only delegate to their sub-components.
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Leaf&quot;</span>


<span class="token keyword">class</span> <span class="token class-name">Composite</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The Composite class represents the complex components that may have
    children. Usually, the Composite objects delegate the actual work to their
    children and then &quot;sum-up&quot; the result.
    &quot;&quot;&quot;</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_children<span class="token punctuation">:</span> List<span class="token punctuation">[</span>Component<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    A composite object can add or remove other components (both simple or
    complex) to or from its child list.
    &quot;&quot;&quot;</span>

    <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> component<span class="token punctuation">:</span> Component<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_children<span class="token punctuation">.</span>append<span class="token punctuation">(</span>component<span class="token punctuation">)</span>
        component<span class="token punctuation">.</span>parent <span class="token operator">=</span> self

    <span class="token keyword">def</span> <span class="token function">remove</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> component<span class="token punctuation">:</span> Component<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>_children<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>component<span class="token punctuation">)</span>
        component<span class="token punctuation">.</span>parent <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">is_composite</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token keyword">def</span> <span class="token function">operation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        The Composite executes its primary logic in a particular way. It
        traverses recursively through all its children, collecting and summing
        their results. Since the composite&#39;s children pass these calls to their
        children and so forth, the whole object tree is traversed as a result.
        &quot;&quot;&quot;</span>

        results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> child <span class="token keyword">in</span> self<span class="token punctuation">.</span>_children<span class="token punctuation">:</span>
            results<span class="token punctuation">.</span>append<span class="token punctuation">(</span>child<span class="token punctuation">.</span>operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;Branch(</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;+&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span>


<span class="token keyword">def</span> <span class="token function">client_code</span><span class="token punctuation">(</span>component<span class="token punctuation">:</span> Component<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    The client code works with all of the components via the base interface.
    &quot;&quot;&quot;</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;RESULT: </span><span class="token interpolation"><span class="token punctuation">{</span>component<span class="token punctuation">.</span>operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">client_code2</span><span class="token punctuation">(</span>component1<span class="token punctuation">:</span> Component<span class="token punctuation">,</span> component2<span class="token punctuation">:</span> Component<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    Thanks to the fact that the child-management operations are declared in the
    base Component class, the client code can work with any component, simple or
    complex, without depending on their concrete classes.
    &quot;&quot;&quot;</span>

    <span class="token keyword">if</span> component1<span class="token punctuation">.</span>is_composite<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        component1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>component2<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;RESULT: </span><span class="token interpolation"><span class="token punctuation">{</span>component1<span class="token punctuation">.</span>operation<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    <span class="token comment"># This way the client code can support the simple leaf components...</span>
    simple <span class="token operator">=</span> Leaf<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Client: I&#39;ve got a simple component:&quot;</span><span class="token punctuation">)</span>
    client_code<span class="token punctuation">(</span>simple<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span>

    <span class="token comment"># ...as well as the complex composites.</span>
    tree <span class="token operator">=</span> Composite<span class="token punctuation">(</span><span class="token punctuation">)</span>

    branch1 <span class="token operator">=</span> Composite<span class="token punctuation">(</span><span class="token punctuation">)</span>
    branch1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Leaf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    branch1<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Leaf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    branch2 <span class="token operator">=</span> Composite<span class="token punctuation">(</span><span class="token punctuation">)</span>
    branch2<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Leaf<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    tree<span class="token punctuation">.</span>add<span class="token punctuation">(</span>branch1<span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>add<span class="token punctuation">(</span>branch2<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Client: Now I&#39;ve got a composite tree:&quot;</span><span class="token punctuation">)</span>
    client_code<span class="token punctuation">(</span>tree<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Client: I don&#39;t need to check the components classes even when managing the tree:&quot;</span><span class="token punctuation">)</span>
    client_code2<span class="token punctuation">(</span>tree<span class="token punctuation">,</span> simple<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2);function Pn(Ln,Vn){const a=l("ExternalLinkIcon");return p(),i("div",null,[r,s("blockquote",null,[s("p",null,[n("文章内容整理自："),s("a",u,[n("refactoringguru.cn/"),t(a)])]),d]),k,s("ul",null,[s("li",null,[s("a",v,[n("桥接模式"),t(a)]),n("通常会于开发前期进行设计， 使你能够将程序的各个部分独立开来以便开发。 另一方面， "),s("a",m,[n("适配器模式"),t(a)]),n("通常在已有程序中使用， 让相互不兼容的类能很好地合作。")]),s("li",null,[s("a",b,[n("适配器"),t(a)]),n("可以对已有对象的接口进行修改， "),s("a",h,[n("装饰模式"),t(a)]),n("则能在不改变对象接口的前提下强化对象功能。 此外， "),g,n("还支持递归组合， "),f,n("则无法实现。")]),s("li",null,[s("a",_,[n("适配器"),t(a)]),n("能为被封装对象提供不同的接口， "),s("a",y,[n("代理模式"),t(a)]),n("能为对象提供相同的接口， "),s("a",q,[n("装饰"),t(a)]),n("则能为对象提供加强的接口。")]),s("li",null,[s("a",w,[n("外观模式"),t(a)]),n("为现有对象定义了一个新接口， "),s("a",C,[n("适配器"),t(a)]),n("则会试图运用已有的接口。 "),x,n("通常只封装一个对象， "),T,n("通常会作用于整个对象子系统上。")]),s("li",null,[s("a",A,[n("桥接"),t(a)]),n("、 "),s("a",S,[n("状态模式"),t(a)]),n("和"),s("a",j,[n("策略模式"),t(a)]),n(" （在某种程度上包括"),s("a",F,[n("适配器"),t(a)]),n("） 模式的接口非常相似。 实际上， 它们都基于"),s("a",I,[n("组合模式"),t(a)]),n("——即将工作委派给其他对象， 不过也各自解决了不同的问题。 模式并不只是以特定方式组织代码的配方， 你还可以使用它们来和其他开发者讨论模式所解决的问题。")])]),D,s("ul",null,[s("li",null,[s("a",N,[n("桥接模式"),t(a)]),n("通常会于开发前期进行设计， 使你能够将程序的各个部分独立开来以便开发。 另一方面， "),s("a",P,[n("适配器模式"),t(a)]),n("通常在已有程序中使用， 让相互不兼容的类能很好地合作。")])]),L,s("ul",null,[s("li",null,[s("a",V,[n("适配器模式"),t(a)]),n("可以对已有对象的接口进行修改， "),s("a",B,[n("装饰模式"),t(a)]),n("则能在不改变对象接口的前提下强化对象功能。 此外， "),z,n("还支持递归组合， "),E,n("则无法实现。")]),s("li",null,[s("a",O,[n("适配器"),t(a)]),n("能为被封装对象提供不同的接口， "),s("a",R,[n("代理模式"),t(a)]),n("能为对象提供相同的接口， "),s("a",U,[n("装饰"),t(a)]),n("则能为对象提供加强的接口。")]),s("li",null,[s("a",W,[n("装饰"),t(a)]),n("和"),s("a",H,[n("代理"),t(a)]),n("有着相似的结构， 但是其意图却非常不同。 这两个模式的构建都基于组合原则， 也就是说一个对象应该将部分工作委派给另一个对象。 两者之间的不同之处在于"),G,n("通常自行管理其服务对象的生命周期， 而"),Y,n("的生成则总是由客户端进行控制。")])]),J,s("ul",null,[s("li",null,[n("外观可能成为与程序中所有类都耦合的"),s("a",K,[n("上帝对象"),t(a)]),n("。God object")])]),M,s("ul",null,[s("li",null,[s("a",Q,[n("外观"),t(a)]),n("与"),s("a",X,[n("代理模式"),t(a)]),n("的相似之处在于它们都缓存了一个复杂实体并自行对其进行初始化。 "),Z,n("与其服务对象遵循同一接口， 使得自己和服务对象可以互换， 在这一点上它与"),$,n("不同")]),s("li",null,[s("a",nn,[n("外观模式"),t(a)]),n("为现有对象定义了一个新接口， "),s("a",sn,[n("适配器模式"),t(a)]),n("则会试图运用已有的接口。 "),an,n("通常只封装一个对象， "),tn,n("通常会作用于整个对象子系统上。")]),s("li",null,[n("当只需对客户端代码隐藏子系统创建对象的方式时， 你可以使用"),s("a",en,[n("抽象工厂模式"),t(a)]),n("来代替"),s("a",on,[n("外观"),t(a)]),n("。")])]),pn,s("ul",null,[s("li",null,[s("a",ln,[n("适配器模式"),t(a)]),n("能为被封装对象提供不同的接口， "),s("a",cn,[n("代理模式"),t(a)]),n("能为对象提供相同的接口， "),s("a",rn,[n("装饰模式"),t(a)]),n("则能为对象提供加强的接口。")]),s("li",null,[s("a",un,[n("外观模式"),t(a)]),n("与"),s("a",dn,[n("代理"),t(a)]),n("的相似之处在于它们都缓存了一个复杂实体并自行对其进行初始化。 "),kn,n("与其服务对象遵循同一接口， 使得自己和服务对象可以互换， 在这一点上它与"),vn,n("不同。")]),s("li",null,[s("a",mn,[n("装饰"),t(a)]),n("和"),s("a",bn,[n("代理"),t(a)]),n("有着相似的结构， 但是其意图却非常不同。 这两个模式的构建都基于组合原则， 也就是说一个对象应该将部分工作委派给另一个对象。 两者之间的不同之处在于"),hn])]),gn,s("ul",null,[s("li",null,[n("你可以使用"),s("a",fn,[n("享元模式"),t(a)]),n("实现"),s("a",_n,[n("组合模式"),t(a)]),n("树的共享叶节点以节省内存。")]),s("li",null,[s("a",yn,[n("享元"),t(a)]),n("展示了如何生成大量的小型对象， "),s("a",qn,[n("外观模式"),t(a)]),n("则展示了如何用一个对象来代表整个子系统。")])]),wn,s("ul",null,[s("li",null,[s("a",Cn,[n("桥接模式"),t(a)]),n("、 "),s("a",xn,[n("状态模式"),t(a)]),n("和"),s("a",Tn,[n("策略模式"),t(a)]),n(" （在某种程度上包括"),s("a",An,[n("适配器模式"),t(a)]),n("） 模式的接口非常相似。 实际上， 它们都基于"),s("a",Sn,[n("组合模式"),t(a)]),n("——即将工作委派给其他对象， 不过也各自解决了不同的问题。 模式并不只是以特定方式组织代码的配方， 你还可以使用它们来和其他开发者讨论模式所解决的问题。")]),s("li",null,[n("你可以在创建复杂"),s("a",jn,[n("组合"),t(a)]),n("树时使用"),s("a",Fn,[n("生成器模式"),t(a)]),n("， 因为这可使其构造步骤以递归的方式运行。")]),s("li",null,[s("a",In,[n("责任链模式"),t(a)]),n("通常和"),s("a",Dn,[n("组合模式"),t(a)]),n("结合使用。 在这种情况下， 叶组件接收到请求后， 可以将请求沿包含全体父组件的链一直传递至对象树的底部。")])]),Nn])}const En=o(c,[["render",Pn],["__file","结构型模式 Structural Patterns.html.vue"]]);export{En as default};
