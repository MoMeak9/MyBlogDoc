import{_ as o}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as p,c as i,a as n,b as a,d as e,e as t,r}from"./app.d7b34baa.js";const c={},l=t('<h1 id="astro-ä¸­é€šè¿‡-node-js-å¯ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“" tabindex="-1"><a class="header-anchor" href="#astro-ä¸­é€šè¿‡-node-js-å¯ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“" aria-hidden="true">#</a> Astro ä¸­é€šè¿‡ Node.js å¯ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“</h1><p>åœ¨ Astro ä¸­å¯ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSR, Server Side Renderingï¼‰éå¸¸ç®€å•ï¼Œè€Œä¸”å¯ç”¨åå¯ä»¥ä½¿ç”¨æ–°çš„ç‰¹æ€§ï¼š</p><ul><li>åœ¨åº”ç”¨ç¨‹åºä¸­å®ç°ç™»å½•çŠ¶æ€ä¼šè¯ã€‚</li><li>ç”¨ <code>fetch</code> åŠ¨æ€è°ƒç”¨ API æ¥æ¸²æŸ“æ•°æ®ã€‚</li><li>é€šè¿‡<strong>é€‚é…å™¨</strong>éƒ¨ç½²ä½ çš„ç½‘ç«™ã€‚</li></ul><h2 id="é€‚é…å™¨" tabindex="-1"><a class="header-anchor" href="#é€‚é…å™¨" aria-hidden="true">#</a> é€‚é…å™¨</h2><p>ä¸ºäº†å¯ç”¨ SSRï¼Œä½ éœ€è¦ä½¿ç”¨é€‚é…å™¨ï¼ˆAdapter)ã€‚è¿™æ˜¯å› ä¸º SSR éœ€è¦æœåŠ¡å™¨<strong>è¿è¡Œæ—¶</strong>ç¯å¢ƒè¿è¡ŒæœåŠ¡ç«¯ä»£ç ã€‚æœåŠ¡ç«¯ä»£ç å¯ä»¥è°ƒç”¨è¯¥è¿è¡Œæ—¶æä¾›çš„ APIã€‚</p><p>å®‰è£…ä¸€ä¸ªé€‚é…å™¨å¯ä»¥è®© Astro è®¿é—®ç›¸åº”çš„ APIï¼Œå¹¶å…è®¸ Astro è¾“å‡ºä¸€ä¸ªè„šæœ¬ï¼ˆserverè„šæœ¬ï¼‰ï¼Œåœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œæˆ‘ä»¬é¡¹ç›®ã€‚</p><p>ç°æœ‰ä»¥ä¸‹é€‚é…å™¨ï¼Œæœªæ¥å°†ä¼šæœ‰æ›´å¤šé€‚é…å™¨æ”¯æŒï¼š</p>',7),d={href:"https://github.com/withastro/astro/tree/main/packages/integrations/cloudflare",target:"_blank",rel:"noopener noreferrer"},u={href:"https://github.com/withastro/astro/tree/main/packages/integrations/deno",target:"_blank",rel:"noopener noreferrer"},k={href:"https://github.com/withastro/astro/tree/main/packages/integrations/netlify",target:"_blank",rel:"noopener noreferrer"},v={href:"https://github.com/withastro/astro/tree/main/packages/integrations/node",target:"_blank",rel:"noopener noreferrer"},m={href:"https://github.com/withastro/astro/tree/main/packages/integrations/vercel",target:"_blank",rel:"noopener noreferrer"},h=t(`<p>æˆ‘ä»¬ä¸»è¦ä»‹ç»Node.js é€‚é…å™¨</p><h2 id="å®‰è£…node-jsé€‚é…å™¨" tabindex="-1"><a class="header-anchor" href="#å®‰è£…node-jsé€‚é…å™¨" aria-hidden="true">#</a> å®‰è£…Node.jsé€‚é…å™¨</h2><p>ä½¿ç”¨ä»¥ä¸‹ astro add å‘½ä»¤æ·»åŠ é€‚é…å™¨ï¼Œä»¥åœ¨ Astro é¡¹ç›®ä¸­å¯ç”¨ SSRã€‚è¿™å°†å®‰è£…é€‚é…å™¨å¹¶ä¸€æ­¥å¯¹é¡¹ç›®çš„ <code>astro.config.mjs</code> æ–‡ä»¶è¿›è¡Œé€‚å½“çš„æ›´æ”¹ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Using NPM</span>
npx astro <span class="token function">add</span> <span class="token function">node</span>
<span class="token comment"># Using Yarn</span>
<span class="token function">yarn</span> astro <span class="token function">add</span> <span class="token function">node</span>
<span class="token comment"># Using PNPM</span>
<span class="token function">pnpm</span> astro <span class="token function">add</span> <span class="token function">node</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ‰‹åŠ¨å®‰è£…ï¼š</strong></p><ol><li><p>åœ¨ç»ˆç«¯ä¸­å®‰è£…Node.jsé€‚é…å™¨</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @astrojs/node
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>åœ¨ <code>astro.config.mjs</code> é¡¹ç›®é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸¤è¡Œ</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// astro.config.mjs</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;astro/config&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> node <span class="token keyword">from</span> <span class="token string">&#39;@astrojs/node&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token string">&#39;server&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">adapter</span><span class="token operator">:</span> <span class="token function">node</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;standalone&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="é…ç½®é¡¹å‚æ•°" tabindex="-1"><a class="header-anchor" href="#é…ç½®é¡¹å‚æ•°" aria-hidden="true">#</a> é…ç½®é¡¹å‚æ•°</h2><p><code>@astrojs/node</code> å¯ä»¥é€šè¿‡å°†é€‰é¡¹å‚æ•°ä¼ é€’ç»™é€‚é…å™¨å‡½æ•°æ¥é…ç½®ï¼š</p><h3 id="mode-æ¨¡å¼è®¾ç½®" tabindex="-1"><a class="header-anchor" href="#mode-æ¨¡å¼è®¾ç½®" aria-hidden="true">#</a> Mode æ¨¡å¼è®¾ç½®</h3><p>æ§åˆ¶é€‚é…å™¨æ˜¯æ„å»ºä¸ºä¸­é—´ä»¶<code>middleware</code>æ¨¡å¼è¿˜æ˜¯ç‹¬ç«‹<code>standalone</code>æ¨¡å¼ã€‚</p><ul><li><p>ä¸­é—´ä»¶æ¨¡å¼å…è®¸å°†æ„å»ºçš„è¾“å‡ºç”¨ä½œå¦ä¸€ä¸ª Node.js æœåŠ¡å™¨çš„ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ Express.js æˆ– Fastifyã€‚</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;astro/config&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> node <span class="token keyword">from</span> <span class="token string">&#39;@astrojs/node&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token string">&#39;server&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">adapter</span><span class="token operator">:</span> <span class="token function">node</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;middleware&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç‹¬ç«‹æ¨¡å¼æ„å»ºçš„æœåŠ¡å™¨è„šæœ¬ï¼Œéšç€å…¥å£æ¨¡å—çš„è¿è¡Œè‡ªåŠ¨å¯åŠ¨ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ›´è½»æ¾åœ°å°†æ„å»ºéƒ¨ç½²åˆ°ä¸»æœºï¼Œè€Œæ— éœ€ä»»ä½•å…¶ä»–ä»£ç ã€‚</p></li></ul><h2 id="å¯åŠ¨" tabindex="-1"><a class="header-anchor" href="#å¯åŠ¨" aria-hidden="true">#</a> å¯åŠ¨</h2><p>æ ¹æ®ä¸¤ç§ä¸åŒçš„æ¨¡å¼ï¼Œæœ‰ç€ä¸åŒçš„å¯åŠ¨å’Œä½¿ç”¨æ–¹æ³•</p><h3 id="ä¸­é—´ä»¶æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#ä¸­é—´ä»¶æ¨¡å¼" aria-hidden="true">#</a> ä¸­é—´ä»¶æ¨¡å¼</h3><p>æœåŠ¡å™¨å…¥å£ç‚¹é»˜è®¤æ„å»ºä¸º <code>./dist/server/entry.mjs</code>ã€‚è¯¥æ¨¡å—å¯¼å‡ºä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œå¯ä»¥ä¸ä»»ä½•æ”¯æŒ Node è¯·æ±‚å’Œå“åº”å¯¹è±¡çš„æ¡†æ¶ä¸€èµ·ä½¿ç”¨ï¼Œæ¯”å¦‚Expressï¼š</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">&#39;express&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> handler <span class="token keyword">as</span> ssrHandler <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./dist/server/entry.mjs&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">&#39;dist/client/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// é™æ€èµ„æºæ–‡ä»¶</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ssrHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ³¨æ„ï¼š</strong> ä¸­é—´ä»¶æ¨¡å¼ä¸æä¾›æ–‡ä»¶æœåŠ¡ï¼Œéœ€è¦é…ç½® HTTP æ¡†æ¶ï¼Œå¦‚ä¸Šä»£ç æ‰€ç¤ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯è¾“å‡ºåœ¨<code> ./dist/client/</code></p><h3 id="ç‹¬ç«‹æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#ç‹¬ç«‹æ¨¡å¼" aria-hidden="true">#</a> ç‹¬ç«‹æ¨¡å¼</h3><p>ç‹¬ç«‹æ¨¡å¼å¯åŠ¨å¾ˆç®€å•ï¼Œåªè¦æ‰§è¡Œæ„å»ºçš„å…¥å£æ–‡ä»¶<code>./dist/server/entry.mjs</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">node</span> ./dist/server/entry.mjs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯¹äºç‹¬ç«‹æ¨¡å¼ï¼ŒæœåŠ¡ç«¯é™¤äº†å¤„ç†é¡µé¢å’Œ API è·¯ç”±ä¹‹å¤–è¿˜å…·æœ‰æ–‡ä»¶æœåŠ¡ã€‚</p><h4 id="è‡ªå®šä¹‰ä¸»æœºå’Œç«¯å£" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰ä¸»æœºå’Œç«¯å£" aria-hidden="true">#</a> è‡ªå®šä¹‰ä¸»æœºå’Œç«¯å£</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token assign-left variable">HOST</span><span class="token operator">=</span><span class="token number">0.0</span>.0.0 <span class="token assign-left variable">PORT</span><span class="token operator">=</span><span class="token number">3000</span> <span class="token function">node</span> ./dist/server/entry.mjs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,23),g=n("p",null,[n("strong",null,"å‚è€ƒï¼š")],-1),b={href:"https://github.com/withastro/astro/tree/main/packages/integrations/node",target:"_blank",rel:"noopener noreferrer"},f={href:"https://docs.astro.build/zh-cn/guides/server-side-rendering/",target:"_blank",rel:"noopener noreferrer"};function _(y,j){const s=r("ExternalLinkIcon");return p(),i("div",null,[l,n("ul",null,[n("li",null,[n("a",d,[a("Cloudflare"),e(s)])]),n("li",null,[n("a",u,[a("Deno"),e(s)])]),n("li",null,[n("a",k,[a("Netlify"),e(s)])]),n("li",null,[n("a",v,[a("Node.js"),e(s)])]),n("li",null,[n("a",m,[a("Vercel"),e(s)])])]),h,n("blockquote",null,[g,n("p",null,[n("a",b,[a("astro/packages/integrations/node at main Â· withastro/astro"),e(s)])]),n("p",null,[n("a",f,[a("æœåŠ¡ç«¯æ¸²æŸ“ ğŸš€ Astro æ–‡æ¡£"),e(s)])])])])}const N=o(c,[["render",_],["__file","Astro ä¸­å¯ç”¨æœåŠ¡å™¨ç«¯æ¸²æŸ“.html.vue"]]);export{N as default};
